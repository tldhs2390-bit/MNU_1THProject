<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      th:fragment="layout(content)">

<head>
    <meta charset="UTF-8">
    <title>MyBlogKso</title>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>

<body>
<div class="page-wrapper">

    <!-- 상단 영역 -->
    <div class="top-wrapper">
        <header>
            <div class="header-inner">
                <a th:href="@{/}" class="logo">MyBlogKso</a>
            </div>
        </header>

        <nav>
            <ul>
                <li><a th:href="@{/user/user_insert}">회원가입</a></li>
                <li><a th:href="@{/board/board_list}">공지사항</a></li>
                <li><a th:href="@{/portfolio/portfolio_list}">포트폴리오</a></li>
                <li><a th:href="@{/question/question_list}">Q/A 게시판</a></li>
            </ul>
        </nav>

        <img src="/img/ksophoto(2).jpeg" alt="프로필 사진" class="profile-img">
    </div>

<script type="text/javascript">
$(function(){
    $("#smscheck").hide();

    $("#userSend").click(function(){
        if($("#name").val()==''){ alert("이름을 입력하세요."); $("#name").focus(); return; }
        if($("#userid").val()==''){ alert("id를 입력하세요."); $("#userid").focus(); return; }
        if($("#passwd").val()==''){ alert("비밀번호를 입력하세요."); $("#passwd").focus(); return; }
        if($("#repasswd").val()==''){ alert("비밀번호확인을 입력하세요."); $("#repasswd").focus(); return; }
        if($("#tel").val()==''){ alert("전화번호를 입력하세요."); $("#tel").focus(); return; }
        $("#user").submit();
    });

    $("#userReset").click(function(){
        alert("모든 지우고 다시 입력합니다.");
        $("#user")[0].reset();
        $("#name").focus();
    });

    $("#userid").change(function(){
        var userid = $("#userid").val();
        $.ajax({
            url:'/user/user_idCheck',
            type:'post',
            data:{'userid':userid},
            success:function(result){
                if(result==0){
                    $("#userID_c").text("사용가능한 아이디입니다.");
                }else{
                    $("#userID_c").text("중복된 아이디입니다.");
                    $("#userid").val('');
                    $("#userid").focus();
                }
            }
        });
    });

    $("#repasswd").change(function(){
        if($("#passwd").val() == $("#repasswd").val()){
            $("#repasswd_c").text("확인되었습니다.");
        }else{
            $("#repasswd_c").text("비밀번호를 다시 입력하세요");
            $("#repasswd").val('');
            $("#repasswd").focus();
        }
    });

    $("#phoneBtn1").click(function(){
        if($("#tel").val()==''){ alert("전화번호를 입력해주세요."); $("#tel").focus(); return; }
        var tel = $("#tel").val();
        $.ajax({
            url:'/user/user_sms',
            type:'post',
            data:{'tel':tel},
            success:function(result){
                $("#phone_c").text("인증번호가 전송되었습니다.");
                $("#usersms").val(result);
            }
        });
        $("#smscheck").show();
    });

    $("#phoneBtn3").click(function(){
        if($("#usersms").val() == $("#resms").val()){
            $("#resms_c").text("인증되었습니다.");
        }else{
            $("#resms_c").text("인증번호가 맞지 않습니다. -- 다시 입력해주세요.");
            $("#resms").val('');
            $("#resms").focus();
        }
    });

    $("#email3").change(function(){
        if($("#email3").val()!=0){
            $("#email2").val($("#email3").val());
            $("#email2").attr("readonly", true);
        }else{
            $("#email2").attr("readonly", false);
            $("#email2").val('');
        }
    });
});
</script>

<!-- 회원가입 완료 후 alert 및 리다이렉트 -->
<script th:inline="javascript">
/*<![CDATA[*/
    var row = /*[[${row}]]*/ 0;
    if(row === 1){
        alert("환영합니다\n\n회원가입되었습니다.");
        window.location.href = /*[[@{/}]]*/ "/";
    }
/*]]>*/
</script>

<section>
    <div style="display:flex; justify-content:center; padding:80px 0;">
        <div style="max-width:600px; width:100%; background-color:#fff; padding:40px; border-radius:10px; box-shadow:0 0 15px rgba(0,0,0,0.1);">

            <h2 style="text-align:center; margin-bottom:20px;">회원가입</h2>

            <form name="user" id="user" method="post" th:action="@{/user/user_insert}" class="board-write-form">
                <input type="hidden" id="usersms" name="usersms">

                <input type="text" id="name" name="name" placeholder="성명" required class="board-input">
                <input type="text" id="userid" name="userid" placeholder="아이디" required class="board-input">
                <div id="userID_c" style="font-size:12px; color:red; margin-bottom:10px;">
                    [5~16자 이내의 영문이나 숫자만 가능합니다.]
                </div>

                <input type="password" id="passwd" name="passwd" placeholder="비밀번호" required class="board-input">
                <input type="password" id="repasswd" name="repasswd" placeholder="비밀번호 확인" required class="board-input">
                <div id="repasswd_c" style="font-size:12px; color:red; margin-bottom:10px;">
                    *비밀번호 확인을 위해서 다시 입력해주세요.
                </div>

                <input type="text" id="tel" name="tel" placeholder="전화번호 (-제외)" required class="board-input">
                <input type="button" id="phoneBtn1" value="인증번호받기" class="board-list-btn-alt-sms">
                <div id="phone_c" style="font-size:12px; color:red; margin-bottom:10px;"></div>

                <div id="smscheck">
                    <input type="text" id="resms" name="resms" placeholder="인증번호 입력" class="board-input">
                    <input type="button" id="phoneBtn3" value="인증" class="board-list-btn-alt">
                    <div id="resms_c" style="font-size:12px; color:red; margin-bottom:10px;"></div>
                </div>

                <button type="submit" id="userSend" class="board-list-btn-alt" style="margin-top:20px;">가입하기</button>
                <button type="button" id="userReset" class="board-list-btn-alt" style="margin-top:10px; background-color:#f44336;">다시쓰기</button>
            </form>

        </div>
    </div>
</section>
</body>
</html>